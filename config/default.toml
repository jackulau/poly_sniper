# Polysniper Configuration

[endpoints]
clob_rest = "https://clob.polymarket.com"
clob_ws = "wss://ws-subscriptions-clob.polymarket.com/ws/"
gamma_api = "https://gamma-api.polymarket.com"

[auth]
# Environment variable containing the private key
private_key_env = "POLYMARKET_PRIVATE_KEY"
# Signature type: 0 = EOA wallet, 1 = Poly Proxy, 2 = Poly Gnosis Safe
signature_type = 0

[risk]
# Maximum position size per market in USD
max_position_size_usd = 5000
# Maximum single order size in USD
max_order_size_usd = 500
# Daily loss limit in USD (stops trading when reached)
daily_loss_limit_usd = 500
# Circuit breaker threshold (halts all trading)
circuit_breaker_loss_usd = 300
# Maximum orders per minute
max_orders_per_minute = 60

# Correlation-aware position limits
[risk.correlation]
# Whether correlation-aware limits are enabled
enabled = true
# Minimum correlation threshold to group markets (0.0 to 1.0)
correlation_threshold = 0.7
# Time window for correlation calculation in seconds
window_secs = 3600
# Maximum total exposure across correlated markets in USD
max_correlated_exposure_usd = 3000

# Manual correlation groups (optional)
# Uncomment and customize to define manual market groupings
# [[risk.correlation.groups]]
# name = "presidential-election"
# markets = ["presidential-election-winner", "electoral-vote-count", "swing-state-*"]
#
# [[risk.correlation.groups]]
# name = "fed-decisions"
# markets = ["fed-rate-decision-*", "fed-chair-*"]

[execution]
# Set to true to log orders without actually submitting
dry_run = true
# Number of retry attempts for failed orders
max_retries = 3
# Delay between retries in milliseconds
retry_delay_ms = 100

# Fill management configuration
[fill_management]
# Whether fill tracking is enabled
enabled = true
# Automatically resubmit remaining quantity when orders expire
auto_resubmit = false
# Minimum remaining size to trigger resubmit
min_resubmit_size = 10.0
# Polling interval for order status updates in milliseconds
poll_interval_ms = 1000
# Maximum number of resubmit attempts per order
max_resubmit_attempts = 3

# Order management (cancel-and-replace) configuration
[order_management]
# Whether automatic order management is enabled
enabled = true
# How often to check managed orders (milliseconds)
check_interval_ms = 500

# Default policy for managed orders
[order_management.default_policy]
# Price drift threshold to trigger replacement (in basis points, 25 = 0.25%)
price_drift_threshold_bps = 25
# Minimum time between replacements (milliseconds)
min_replace_interval_ms = 1000
# Maximum number of replacements per order
max_replacements = 10
# Whether to chase price (follow market direction)
chase_enabled = true
# How aggressively to chase (0.0 = stay at original, 1.0 = follow mid)
chase_aggression = 0.5

# Phase 5: SQLite Persistence
[persistence]
# Whether persistence is enabled
enabled = true
# Path to SQLite database file
db_path = "data/polysniper.db"
# Price snapshot interval in seconds
price_snapshot_interval_secs = 60
# Maximum price snapshots to keep per token
max_price_snapshots = 10000

# Phase 6: Prometheus Metrics
[metrics]
# Whether metrics are enabled
enabled = true
# Port for metrics HTTP server (accessible at http://localhost:9090/metrics)
port = 9090
# Collection interval in seconds
collection_interval_secs = 60

# Phase 7: Alerting
[alerting]
# Whether alerting is enabled
enabled = true
# Minimum alert level to send (info, warning, critical)
min_level = "warning"
# Rate limit between duplicate alerts in seconds
rate_limit_seconds = 60

# Slack webhook configuration
[alerting.slack]
enabled = false
webhook_url = ""
channel = "#polysniper-alerts"
username = "Polysniper"
icon_emoji = ":chart_with_upwards_trend:"

# Telegram bot configuration
[alerting.telegram]
enabled = false
bot_token = ""
chat_id = ""
parse_mode = "HTML"

# Gas Price Tracking
[gas]
# Whether gas tracking is enabled
enabled = true
# Poll interval in seconds
poll_interval_secs = 10
# Primary RPC endpoint for eth_gasPrice
rpc_endpoint = "https://polygon-rpc.com"
# Fallback Polygonscan Gas Oracle API endpoint (optional)
# fallback_endpoint = "https://api.polygonscan.com/api?module=gastracker&action=gasoracle"
# Cache TTL in seconds
cache_ttl_secs = 10
# History duration in seconds (1 hour)
history_duration_secs = 3600

# Gas condition thresholds (in gwei)
[gas.thresholds]
# Below this is considered Low
low = 30
# Below this is considered Normal (above low)
normal = 100
# Below this is considered High (above normal) - above this is Extreme
high = 300

# Gas Optimization - intelligent order timing based on gas prices
[gas.optimization]
# Whether gas optimization is enabled
enabled = true
# Enable order batching for same token/market
batch_enabled = true
# Minimum orders to batch before considering batch submission
batch_min_orders = 2
# Maximum time to wait for batch accumulation (seconds)
batch_max_wait_secs = 30
# Queue processing interval in milliseconds
queue_process_interval_ms = 1000

# CRITICAL priority: Execute immediately regardless of gas
[gas.optimization.critical]
# Maximum gas price in gwei (high limit for critical)
max_gas_gwei = 1000
# Maximum time to wait in queue (0 = never queue)
max_queue_time_secs = 0
# Execution strategy: immediate, wait_for_low, or time_window
strategy = "immediate"

# HIGH priority: Short delay acceptable, still time-sensitive
[gas.optimization.high]
max_gas_gwei = 200
max_queue_time_secs = 60
strategy = "time_window"

# NORMAL priority: Standard orders, can wait for better gas
[gas.optimization.normal]
max_gas_gwei = 100
max_queue_time_secs = 300
strategy = "wait_for_low"

# LOW priority: Non-urgent, maximize gas savings
[gas.optimization.low]
max_gas_gwei = 50
max_queue_time_secs = 900
strategy = "wait_for_low"
